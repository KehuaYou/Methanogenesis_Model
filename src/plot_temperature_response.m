% Plot of temperature response factor for biodegradation of organic carbon
% Tempereature response factor is the ratio of the reactivity of the
% organic carbon at any temperature to the reactivity at the reference
% temeprature

%% ============ Compiled data from literature ==================
% data from Katterer et al. (1998), and rivkina et al. (2002)
% Temperature, response factor @ Tref=30, response factor @ Tref = 4oC
data = [
-16.5	0.000118232	0.002099998
-10	0.000669982	0.011900002
-5	0.002235151	0.039700023
-1.8	0.034839073	0.618800252
0.440607	0.033638	0.597467185
1.91623	0.00469143	0.08332765
3.75508	0.0841555	1.494742545
3.75605	0.0644709	1.145111099
4	0.056301023	1.000000409
4.6184	0.0155978	0.277043037
4.86168	0.0649062	1.152842756
4.9821	0.114166	2.027779258
5	0.06	1.065700432    
5.23215	0.025682	0.456155308
5.34533	0.222577	3.953340083
6.93751	0.321629	5.712669402
7.06665	0.193727	3.440915792
7.07052	0.114988	2.042379354
9.89118	0.214524	3.810305323
10.0029	0.440946	7.831939042
10.0087	0.322838	5.734143266
10.0189	0.116149	2.063000657
11.9762	0.284243	5.048631463
14.9236	0.305088	5.418873555
15.0421	0.393717	6.993072947
15.0445	0.344506	6.119003215
15.0556	0.118132	2.098222056
15.1712	0.265815	4.721319337
15.1765	0.15755	2.798351717
16.1443	0.463049	8.224525319
18.1094	0.473665	8.413083249
19.0825	0.670899	11.91628923
19.9584	0.34644	6.153354292
20.0827	0.316962	5.62977567
20.1949	0.533541	9.476581233
20.1968	0.494172	8.777321895
22.0333	0.622848	11.06282304
22.159	0.563842	10.01477771
23.9955	0.692518	12.30027886
24.853	0.742068	13.1803698
24.97	0.860224	15.27901813
24.9797	0.663378	11.78270368
25.1059	0.59453	10.55984796
25.2273	0.624105	11.08514946
27.0565	0.900416	15.99289533
27.1832	0.821726	14.59522921
27.914	0.949966	16.87298627
29.9985	1.02953	18.28617609
30.0005	0.990158	17.58686347
34.6435	1.5038	26.71000515
34.6513	1.34632	23.91289675
34.6605	1.15932	20.59146374
34.7775	1.27747	22.69000551
34.9052	1.1791	20.94278965
35.0145	1.45473	25.83843981
35.1354	1.49415	26.538605
35.1359	1.48431	26.36383013
35.1524	1.14967	20.42006359
36.7353	1.43572	25.50079039
36.8621	1.35703	24.10312428
37.1111	1.28823	22.88112112
37.7143	1.51485	26.90627165
38.329	1.50525	26.73575958
39.5299	2.06674	36.70876183
40.0242	2.00788	35.66330971
40.1451	2.0473	36.36347489

];

T = data(:,1);
r = data(:,3);

scatter(T,r,'k')

%% ==================== model =========================
% Find model in Katterer et al. (1998)
T_test = (-20:1:50);
Tmin = -17;
Tref = 4;
r_predict = ((T_test-Tmin)./(Tref-Tmin)).^4;

hold on 
plot(T_test,r_predict,'b','LineWidth',1)
xlim([-20 20])
ylim([0 10])
set(gca,'FontSize',20,'LineWidth',1)
xlabel('Temperature, (^oC)','FontSize',20)
ylabel('Temperature response factor, (-)','FontSize',20)
box on
